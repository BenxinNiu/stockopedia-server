<html>
<head>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">

$(document).ready(function(){

  google.charts.load('current', {'packages':['corechart']});
  //google.charts.setOnLoadCallback(drawChart());

    // var getData= [['time','price']];
    // var urlAddress = "/historicalprice/AAPL/current_year";


function acquireData(ticker, type){
  $.ajax({
            url: "/historicalprice/" +ticker +"/" + type,
            type: "GET",
            success: function(result){
              var getData=[['time','price']];
              var length = result.length;
              for(i=0;i<length;i++){
              getData.push([result[length-i-1].date,result[length-i-1].close]);
              // $("#cureve_chart").empty();
               drawChart(getData);
                } // forloop
              },
            error:function(err){
              console.log("errorssss");
            console.log(err);
         }

      });
}
//default display

acquireData("AAPL","tmp");
function drawChart(getData) {

var chart=  new google.visualization.LineChart(document.getElementById('curve_chart'));

  var options = {
    title: 'Stock Price',
    curveType: 'function',
    legend: { position: 'bottom' }
  };

  chart.clearChart();

  chart.draw(google.visualization.arrayToDataTable(getData), options);
}

// Draw the line char
    //Assign the right url to urlAddress by clicking different buttons
    $( "#current_year" ).click(function() {

         acquireData("AAPL","current_year")
    });

    $( "#prev_year" ).click(function() {

         acquireData("AAPL","prev_year")
    });

     $( "#one_month" ).click(function(){
         acquireData("AAPL","current_month")

        });
              //chart.clearChart();

    $( "#one_week" ).click(function() {
         acquireData("AAPL","tmp");

      });


    });
    // document ready




</script>
    <head>
        <link rel="stylesheet" href="index.css">

   </head>
<body>
<h1>Stockopedia</h1>
<div id="curve_chart" style="width: 900px; height: 500px"></div>
    <div class="btn-group container">
        <div class="row">
               <button id="current_year">Current Year</button>
               <button id="prev_year">Previous Year</button>
                <button id="one_week"> One Week</button>
                <button id="one_month"> One Month</button>
        </div>
    </div>

</body>
</html>
